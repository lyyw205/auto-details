<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=860">
  <title>Widget Preview — ref-test-sample v3 trace</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" as="style" crossorigin
    href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

  <script>
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: { pretendard: ['Pretendard', 'system-ui', '-apple-system', 'sans-serif'] },
        fontSize: {
          'hero':    ['56px', { lineHeight: '1.2', letterSpacing: '-0.02em', fontWeight: '700' }],
          'section': ['40px', { lineHeight: '1.3', letterSpacing: '-0.02em', fontWeight: '700' }],
          'sub':     ['28px', { lineHeight: '1.4', letterSpacing: '-0.01em', fontWeight: '500' }],
          'body':    ['22px', { lineHeight: '1.6', fontWeight: '400' }],
          'small':   ['20px', { lineHeight: '1.6', fontWeight: '400' }],
          'caption': ['14px', { lineHeight: '1.5', fontWeight: '400' }],
        },
        colors: {
          brand: 'var(--brand-main)',
          accent: 'var(--accent)',
          dark: { 1: '#111111', 2: '#1A1A1A' },
          sub: '#888888',
          muted: '#666666',
          placeholder: '#2A2A2A',
        },
        width: { 'canvas': '860px', 'content': '760px' },
      },
    },
  }
  </script>

  <style>
    :root { --brand-main: #3D5A80; --accent: #D4A76A; }

    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Pretendard', system-ui, -apple-system, sans-serif;
      background: #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .page-canvas {
      width: 860px;
      max-width: 860px;
      min-width: 860px;
      overflow: hidden;
      position: relative;
    }

    .img-placeholder {
      background: #2A2A2A;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
      color: #666;
      overflow: hidden;
    }
    .img-placeholder .img-label {
      font-size: 12px;
      color: #888;
      text-align: center;
      padding: 0 8px;
    }

    .widget-label {
      background: #333;
      color: #fff;
      padding: 8px 16px;
      font-size: 13px;
      font-family: monospace;
      display: flex;
      align-items: center;
      gap: 8px;
      width: 860px;
    }
    .widget-label .badge {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
    }
    .badge-trace { background: #ff6b6b; color: white; }
    .badge-light { background: #ffd43b; color: #333; }

    .trace-controls {
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 9999;
      background: rgba(0,0,0,0.85);
      border-radius: 12px;
      padding: 16px;
      color: white;
      font-size: 13px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      min-width: 220px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.1);
    }
    .trace-controls h3 { font-size: 14px; font-weight: 700; margin: 0; color: #ff6b6b; }
    .trace-controls label { display: flex; align-items: center; gap: 8px; cursor: pointer; }
    .trace-controls input[type="range"] { width: 100%; accent-color: #ff6b6b; }
    .trace-controls input[type="checkbox"] { accent-color: #ff6b6b; }

    .ref-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 860px;
      pointer-events: none;
      z-index: 1000;
      opacity: 0.5;
      display: none;
    }

    [data-trace-bounds] { position: relative; }
    .show-bounds [data-trace-bounds] > div { outline: 1px dashed rgba(255, 107, 107, 0.4); }
  </style>
</head>
<body>
  <!-- 컨트롤 패널 -->
  <div class="trace-controls">
    <h3>v3 Trace Controls</h3>
    <label>
      <input type="checkbox" id="toggleRef" onchange="toggleReference()">
      레퍼런스 오버레이
    </label>
    <div>
      <label>투명도: <span id="opacityVal">50%</span></label>
      <input type="range" id="refOpacity" min="0" max="100" value="50" oninput="updateOpacity(this.value)">
    </div>
    <label>
      <input type="checkbox" id="toggleBounds" onchange="toggleBoundsOutline()">
      Bounds 아웃라인
    </label>
    <label>
      <input type="checkbox" id="toggleDemo" onchange="toggleDemoMode()">
      Demo 모드
    </label>
  </div>

  <div class="preview-header" style="width:860px; padding:24px; background:#222; color:white; text-align:center;">
    <h1 style="font-size:20px; margin:0 0 8px;">ref-test-sample — v3 Trace Preview</h1>
    <p style="font-size:13px; color:#888; margin:0;">2개 위젯 · 내추럴, 클린, 식품 · <span style="color:#ff6b6b; font-weight:700;">v3 trace mode</span></p>
  </div>

  <div class="page-canvas" id="pageCanvas">
    <!-- 레퍼런스 오버레이 -->
    <img class="ref-overlay" id="refOverlay" src="../references/test-sample.png" alt="Reference">

    <!-- #1 FeatureDetail -->
    <div class="widget-label">
      #1 FeatureDetail — featuredetail--ref-test-sample--v3-stack-light
      <span class="badge badge-trace">v3 trace</span>
      <span class="badge badge-light">light</span>
    </div>
    <section id="featuredetail" data-trace-bounds="featuredetail"
             style="position: relative; width: 860px; height: 1000px; overflow: hidden; background: #F5EFE6;">
      <div style="position: absolute; left: 15px; top: 15px; width: 130px; height: 40px;">
        <span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #3D5A80; color: #FFFFFF; border-radius: 8px; font-size: 13px; font-weight: 500;">Point 03</span>
      </div>
      <div style="position: absolute; left: 100px; top: 80px; width: 660px;">
        <p style="font-size: 16px; font-weight: 400; color: #888888; text-align: center; margin: 0; line-height: 1.4;">[포인트 서브 헤딩]</p>
      </div>
      <div style="position: absolute; left: 180px; top: 115px; width: 500px;">
        <p style="font-size: 28px; font-weight: 700; color: #2D2D2D; text-align: center; margin: 0; line-height: 1.4;">[포인트 메인 헤딩]</p>
      </div>
      <!-- 카드 1 -->
      <div style="position: absolute; left: 20px; top: 190px; width: 400px; height: 340px; background: #FFFFFF; border-radius: 12px; overflow: hidden;">
        <div class="img-placeholder" style="position: absolute; left: 10px; top: 5px; width: 380px; height: 230px; border-radius: 10px;"
             data-ai-prompt="Vietnamese cashew nut farm, workers sorting raw cashew nuts in open field, natural sunlight"
             data-ai-style="product_lifestyle" data-ai-ratio="16:9">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
          <span class="img-label">프로세스 1 이미지</span>
        </div>
        <div style="position: absolute; left: 10px; top: 285px; width: 380px;">
          <p style="font-size: 14px; font-weight: 400; color: #2D2D2D; text-align: center; margin: 0; line-height: 1.4;">[프로세스 1 설명]</p>
        </div>
      </div>
      <!-- 카드 2 -->
      <div style="position: absolute; left: 440px; top: 190px; width: 400px; height: 340px; background: #FFFFFF; border-radius: 12px; overflow: hidden;">
        <div class="img-placeholder" style="position: absolute; left: 10px; top: 5px; width: 380px; height: 230px; border-radius: 10px;"
             data-ai-prompt="Roasted cashew nuts on ceramic plate, warm golden tones, close-up food photography"
             data-ai-style="product_detail" data-ai-ratio="16:9">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
          <span class="img-label">프로세스 2 이미지</span>
        </div>
        <div style="position: absolute; left: 10px; top: 285px; width: 380px;">
          <p style="font-size: 14px; font-weight: 400; color: #2D2D2D; text-align: center; margin: 0; line-height: 1.4;">[프로세스 2 설명]</p>
        </div>
      </div>
      <!-- 카드 3 -->
      <div style="position: absolute; left: 20px; top: 560px; width: 400px; height: 340px; background: #FFFFFF; border-radius: 12px; overflow: hidden;">
        <div class="img-placeholder" style="position: absolute; left: 10px; top: 5px; width: 380px; height: 230px; border-radius: 10px;"
             data-ai-prompt="Clean food manufacturing facility, HACCP certified, stainless steel equipment, hygienic processing"
             data-ai-style="infographic" data-ai-ratio="16:9">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
          <span class="img-label">프로세스 3 이미지</span>
        </div>
        <div style="position: absolute; left: 10px; top: 285px; width: 380px;">
          <p style="font-size: 14px; font-weight: 400; color: #2D2D2D; text-align: center; margin: 0; line-height: 1.4;">[프로세스 3 설명]</p>
        </div>
      </div>
      <!-- 카드 4 -->
      <div style="position: absolute; left: 440px; top: 560px; width: 400px; height: 340px; background: #FFFFFF; border-radius: 12px; overflow: hidden;">
        <div class="img-placeholder" style="position: absolute; left: 10px; top: 5px; width: 380px; height: 230px; border-radius: 10px;"
             data-ai-prompt="Sealed food package, quality inspection of cashew nut bag, freshness testing, clean product photography"
             data-ai-style="product_detail" data-ai-ratio="16:9">
          <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
          <span class="img-label">프로세스 4 이미지</span>
        </div>
        <div style="position: absolute; left: 10px; top: 285px; width: 380px;">
          <p style="font-size: 14px; font-weight: 400; color: #2D2D2D; text-align: center; margin: 0; line-height: 1.4;">[프로세스 4 설명]</p>
        </div>
      </div>
      <!-- 넘버 서클 -->
      <div style="position: absolute; left: 200px; top: 435px; width: 40px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #3D5A80; color: #FFFFFF; border-radius: 9999px; font-size: 14px; font-weight: 600;">①</span></div>
      <div style="position: absolute; left: 620px; top: 435px; width: 40px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #3D5A80; color: #FFFFFF; border-radius: 9999px; font-size: 14px; font-weight: 600;">②</span></div>
      <div style="position: absolute; left: 200px; top: 805px; width: 40px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #3D5A80; color: #FFFFFF; border-radius: 9999px; font-size: 14px; font-weight: 600;">③</span></div>
      <div style="position: absolute; left: 620px; top: 805px; width: 40px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: #3D5A80; color: #FFFFFF; border-radius: 9999px; font-size: 14px; font-weight: 600;">④</span></div>
    </section>

    <!-- #2 Differentiator -->
    <div class="widget-label">
      #2 Differentiator — differentiator--ref-test-sample--v3
      <span class="badge badge-trace">v3 trace</span>
      <span class="badge badge-light">light</span>
    </div>
    <section id="differentiator" data-trace-bounds="differentiator"
             style="position: relative; width: 860px; height: 950px; overflow: hidden; background: #FFFFFF;">
      <div style="position: absolute; left: 115px; top: 80px; width: 630px;">
        <p style="font-size: 28px; font-weight: 700; color: #2D2D2D; text-align: center; margin: 0; line-height: 1.4;">[차별화 헤딩]</p>
      </div>
      <div style="position: absolute; left: 80px; top: 145px; width: 700px;">
        <p style="font-size: 15px; font-weight: 400; color: #888888; text-align: center; margin: 0; line-height: 1.6;">[차별화 설명]</p>
      </div>
      <div class="img-placeholder" style="position: absolute; left: 40px; top: 260px; width: 780px; height: 540px;"
           data-ai-prompt="Roasted cashew nut product package bag with loose cashew nuts scattered, clean white background, premium food photography"
           data-ai-style="product_hero" data-ai-ratio="4:3">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
        <span class="img-label">제품 패키지 이미지</span>
      </div>
      <div style="position: absolute; left: 210px; top: 860px; width: 120px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: rgba(61,90,128,0.08); color: #3D5A80; border-radius: 9999px; font-size: 13px; font-weight: 500;">NO 향료</span></div>
      <div style="position: absolute; left: 370px; top: 860px; width: 120px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: rgba(61,90,128,0.08); color: #3D5A80; border-radius: 9999px; font-size: 13px; font-weight: 500;">NO 보존료</span></div>
      <div style="position: absolute; left: 530px; top: 860px; width: 120px; height: 40px;"><span style="display: inline-flex; align-items: center; justify-content: center; width: 100%; height: 100%; background: rgba(61,90,128,0.08); color: #3D5A80; border-radius: 9999px; font-size: 13px; font-weight: 500;">NO 색소</span></div>
    </section>
  </div>

  <script>
    // --- 레퍼런스 오버레이 ---
    function toggleReference() {
      const overlay = document.getElementById('refOverlay');
      overlay.style.display = document.getElementById('toggleRef').checked ? 'block' : 'none';
    }
    function updateOpacity(val) {
      document.getElementById('refOverlay').style.opacity = val / 100;
      document.getElementById('opacityVal').textContent = val + '%';
    }
    function toggleBoundsOutline() {
      document.getElementById('pageCanvas').classList.toggle('show-bounds',
        document.getElementById('toggleBounds').checked);
    }

    // --- Demo 모드 ---
    const DEMO_TEXTS = {
      "[포인트 서브 헤딩]": "꼼꼼한 성산관리로 완성한",
      "[포인트 메인 헤딩]": "안심 먹거리 캐슈넛",
      "[프로세스 1 설명]": "베트남 현지 농장 선별 수확",
      "[프로세스 2 설명]": "수입전문 TESTA 로스팅 가공",
      "[프로세스 3 설명]": "국내 인가시설에서 재가공 및 포장",
      "[프로세스 4 설명]": "신선도 관능 확인",
      "[차별화 헤딩]": "바삭하고 진한 견과 풍미",
      "[차별화 설명]": "소량씩 소금만으로 간을 한 가벼운 로스팅 방식으로,<br>과하지 않고 깔끔한 맛과 풍미를 즐길 수 있습니다."
    };
    const DEMO_IMAGES = [
      { label: "프로세스 1 이미지", src: "https://images.unsplash.com/photo-1464226184884-fa280b87c399?w=380&fit=crop&q=80", alt: "베트남 농장" },
      { label: "프로세스 2 이미지", src: "https://images.unsplash.com/photo-1599599810769-bcde5a160d32?w=380&fit=crop&q=80", alt: "로스팅 캐슈넛" },
      { label: "프로세스 3 이미지", src: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=380&fit=crop&q=80", alt: "제조 시설" },
      { label: "프로세스 4 이미지", src: "https://images.unsplash.com/photo-1607623814075-e51df1bdc82f?w=380&fit=crop&q=80", alt: "품질 검사" },
      { label: "제품 패키지 이미지", src: "https://images.unsplash.com/photo-1604329760661-e71dc83f8f26?w=760&fit=crop&q=80", alt: "캐슈넛 패키지" }
    ];

    let originalHTML = null;

    function toggleDemoMode() {
      const canvas = document.getElementById('pageCanvas');
      const isDemo = document.getElementById('toggleDemo').checked;

      if (isDemo) {
        if (!originalHTML) originalHTML = canvas.innerHTML;
        let html = canvas.innerHTML;

        // 텍스트 치환
        for (const [placeholder, value] of Object.entries(DEMO_TEXTS)) {
          html = html.split(placeholder).join(value);
        }

        // 이미지 치환
        for (const imgData of DEMO_IMAGES) {
          const labelEscaped = imgData.label.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
          const regex = new RegExp(
            '<div class="img-placeholder"([^>]*)>[\\s\\S]*?<span class="img-label">' + labelEscaped + '</span>[\\s\\S]*?</div>',
            'g'
          );
          html = html.replace(regex, (match, attrs) => {
            const styleMatch = attrs.match(/style="([^"]*)"/);
            const style = styleMatch ? styleMatch[1] : '';
            return `<div${attrs.replace('class="img-placeholder"', '')} style="${style}"><img src="${imgData.src}" alt="${imgData.alt}" style="width:100%;height:100%;object-fit:cover;border-radius:inherit;"></div>`;
          });
        }

        canvas.innerHTML = html;
      } else {
        if (originalHTML) {
          canvas.innerHTML = originalHTML;
          originalHTML = null;
        }
      }
    }
  </script>
</body>
</html>
